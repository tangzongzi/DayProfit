# 采购利润计算系统

这是一个网页应用程序，用于上传采购单表格并自动计算每日利润情况。适用于电商店铺根据采购单计算商品利润。

## 功能特点

- 上传采购单Excel/CSV表格文件
- 自动筛选交易成功的记录
- 计算每日利润（店铺商品小计 - 小计金额）
- 以表格形式展示详细数据
- 生成可视化图表
- 计算总收入、总支出和总利润

## 使用需求

- Python 3.7+
- Flask
- pandas
- openpyxl (Excel文件支持)
- xlrd (旧版Excel格式支持)

## 安装和运行

1. 克隆或下载此仓库
2. 安装依赖项：
   ```
   pip install -r requirements.txt
   ```
3. 运行应用：
   ```
   python app.py
   ```
4. 在浏览器中打开 http://127.0.0.1:5000

## 表格格式要求

上传的采购单表格文件必须包含以下列：

- `创建时间`: 订单创建时间
- `小计金额`: 采购成本
- `店铺商品小计`: 店铺商品收入
- `采购单状态`: 交易状态

系统会自动：
1. 筛选"采购单状态"为"交易成功"的记录
2. 计算利润 = 店铺商品小计 - 小计金额
3. 按日期分组汇总显示利润

## 示例表格结构

| 采购单号 | 创建时间 | 小计金额 | 店铺商品小计 | 采购单状态 | ... |
|---------|---------|----------|------------|----------|-----|
| A001    | 2025-05-01 | 100.00  | 150.00     | 交易成功   | ... |
| A002    | 2025-05-01 | 200.00  | 350.00     | 交易成功   | ... |
| A003    | 2025-05-02 | 150.00  | 200.00     | 交易成功   | ... |
| A004    | 2025-05-02 | 80.00   | 120.00     | 交易关闭   | ... |

注意：系统会忽略"交易关闭"的记录。

## 注意事项

- 支持的文件格式：.xlsx, .xls, .csv
- 文件大小限制: 10MB 